human014 <- mcf50_bbduk_014 %>% filter(filename == 'GRCh38.fasta')
mcf50_bbduk_014 <- mcf50_bbduk_014 %>% filter(filename != 'GRCh38.fasta')
mcf50_bbduk_014 <- data.frame( human_reads = sum(human014$reads),
bacterial_reads = sum(mcf50_bbduk_014$reads),
dataset='014',
condition='mcf50_bbduk')
human022 <- mcf50_bbduk_022 %>% filter(filename == 'GRCh38.fasta')
mcf50_bbduk_022 <- mcf50_bbduk_022 %>% filter(filename != 'GRCh38.fasta')
mcf50_bbduk_022 <- data.frame( human_reads = sum(human022$reads),
bacterial_reads = sum(mcf50_bbduk_022$reads),
dataset='022',
condition='mcf50_bbduk')
human025 <- mcf50_bbduk_025 %>% filter(filename == 'GRCh38.fasta')
mcf50_bbduk_025 <- mcf50_bbduk_025 %>% filter(filename != 'GRCh38.fasta')
mcf50_bbduk_025 <- data.frame( human_reads = sum(human025$reads),
bacterial_reads = sum(mcf50_bbduk_025$reads),
dataset='025',
condition='mcf50_bbduk')
human002 <- mcf50_bbduk_002 %>% filter(filename == 'GRCh38.fasta')
mcf50_bbduk_002 <- mcf50_bbduk_002 %>% filter(filename != 'GRCh38.fasta')
mcf50_bbduk_002 <- data.frame( human_reads = sum(human002$reads),
bacterial_reads = sum(mcf50_bbduk_002$reads),
dataset='002',
condition='mcf50_bbduk')
human004 <- mcf50_bbduk_004 %>% filter(filename == 'GRCh38.fasta')
mcf50_bbduk_004 <- mcf50_bbduk_004 %>% filter(filename != 'GRCh38.fasta')
mcf50_bbduk_004 <- data.frame( human_reads = sum(human004$reads),
bacterial_reads = sum(mcf50_bbduk_004$reads),
dataset='004',
condition='mcf50_bbduk')
human012 <- mcf50_bbduk_012 %>% filter(filename == 'GRCh38.fasta')
mcf50_bbduk_012 <- mcf50_bbduk_012 %>% filter(filename != 'GRCh38.fasta')
mcf50_bbduk_012 <- data.frame( human_reads = sum(human012$reads),
bacterial_reads = sum(mcf50_bbduk_012$reads),
dataset='012',
condition='mcf50_bbduk')
human015 <- mcf50_bbduk_015 %>% filter(filename == 'GRCh38.fasta')
mcf50_bbduk_015 <- mcf50_bbduk_015 %>% filter(filename != 'GRCh38.fasta')
mcf50_bbduk_015 <- data.frame( human_reads = sum(human015$reads),
bacterial_reads = sum(mcf50_bbduk_015$reads),
dataset='015',
condition='mcf50_bbduk')
human024 <- mcf50_bbduk_024 %>% filter(filename == 'GRCh38.fasta')
mcf50_bbduk_024 <- mcf50_bbduk_024 %>% filter(filename != 'GRCh38.fasta')
mcf50_bbduk_024 <- data.frame( human_reads = sum(human024$reads),
bacterial_reads = sum(mcf50_bbduk_024$reads),
dataset='024',
condition='mcf50_bbduk')
#form single data frame of all mcf50_bbduk results
mcf50_bbduk <- rbind(mcf50_bbduk_001, mcf50_bbduk_002, mcf50_bbduk_003, mcf50_bbduk_004, mcf50_bbduk_011, mcf50_bbduk_012, mcf50_bbduk_014, mcf50_bbduk_015, mcf50_bbduk_022, mcf50_bbduk_024, mcf50_bbduk_025)
rm(mcf50_bbduk_001, mcf50_bbduk_002, mcf50_bbduk_003, mcf50_bbduk_004, mcf50_bbduk_011, mcf50_bbduk_012, mcf50_bbduk_014, mcf50_bbduk_015, mcf50_bbduk_022, mcf50_bbduk_024, mcf50_bbduk_025)
rm(human001, human002, human003, human004, human011, human012, human014, human015, human022, human025, human024)
#### load in kontaminant files in same fashion ####
kontaminant_001 <- read_tsv(file= '~/Desktop/sepath_paper/human_depletion/tool_comparison/kontaminant/001_seq_counts', col_names=c('filename', 'reads'))
kontaminant_003 <- read_tsv(file= '~/Desktop/sepath_paper/human_depletion/tool_comparison/kontaminant/003_seq_counts', col_names=c('filename', 'reads'))
kontaminant_011 <- read_tsv(file= '~/Desktop/sepath_paper/human_depletion/tool_comparison/kontaminant/011_seq_counts', col_names=c('filename', 'reads'))
kontaminant_014 <- read_tsv(file= '~/Desktop/sepath_paper/human_depletion/tool_comparison/kontaminant/014_seq_counts', col_names=c('filename', 'reads'))
kontaminant_022 <- read_tsv(file= '~/Desktop/sepath_paper/human_depletion/tool_comparison/kontaminant/022_seq_counts', col_names=c('filename', 'reads'))
kontaminant_025 <- read_tsv(file= '~/Desktop/sepath_paper/human_depletion/tool_comparison/kontaminant/025_seq_counts', col_names=c('filename', 'reads'))
kontaminant_002 <- read_tsv(file= '~/Desktop/sepath_paper/human_depletion/tool_comparison/kontaminant/002_seq_counts', col_names=c('filename', 'reads'))
kontaminant_004 <- read_tsv(file= '~/Desktop/sepath_paper/human_depletion/tool_comparison/kontaminant/004_seq_counts', col_names=c('filename', 'reads'))
kontaminant_012 <- read_tsv(file= '~/Desktop/sepath_paper/human_depletion/tool_comparison/kontaminant/012_seq_counts', col_names=c('filename', 'reads'))
kontaminant_015 <- read_tsv(file= '~/Desktop/sepath_paper/human_depletion/tool_comparison/kontaminant/015_seq_counts', col_names=c('filename', 'reads'))
kontaminant_024 <- read_tsv(file= '~/Desktop/sepath_paper/human_depletion/tool_comparison/kontaminant/024_seq_counts', col_names=c('filename', 'reads'))
#form bacteria vs human for kontaminant reads
human001 <- kontaminant_001 %>% filter(filename == 'GRCh38.fasta')
kontaminant_001 <- kontaminant_001 %>% filter(filename != 'GRCh38.fasta')
kontaminant_001 <- data.frame( human_reads = sum(human001$reads),
bacterial_reads = sum(kontaminant_001$reads),
dataset='001',
condition='kontaminant')
human003 <- kontaminant_003 %>% filter(filename == 'GRCh38.fasta')
kontaminant_003 <- kontaminant_003 %>% filter(filename != 'GRCh38.fasta')
kontaminant_003 <- data.frame( human_reads = sum(human003$reads),
bacterial_reads = sum(kontaminant_003$reads),
dataset='003',
condition='kontaminant')
human011 <- kontaminant_011 %>% filter(filename == 'GRCh38.fasta')
kontaminant_011 <- kontaminant_011 %>% filter(filename != 'GRCh38.fasta')
kontaminant_011 <- data.frame( human_reads = sum(human011$reads),
bacterial_reads = sum(kontaminant_011$reads),
dataset='011',
condition='kontaminant')
human014 <- kontaminant_014 %>% filter(filename == 'GRCh38.fasta')
kontaminant_014 <- kontaminant_014 %>% filter(filename != 'GRCh38.fasta')
kontaminant_014 <- data.frame( human_reads = sum(human014$reads),
bacterial_reads = sum(kontaminant_014$reads),
dataset='014',
condition='kontaminant')
human022 <- kontaminant_022 %>% filter(filename == 'GRCh38.fasta')
kontaminant_022 <- kontaminant_022 %>% filter(filename != 'GRCh38.fasta')
kontaminant_022 <- data.frame( human_reads = sum(human022$reads),
bacterial_reads = sum(kontaminant_022$reads),
dataset='022',
condition='kontaminant')
human025 <- kontaminant_025 %>% filter(filename == 'GRCh38.fasta')
kontaminant_025 <- kontaminant_025 %>% filter(filename != 'GRCh38.fasta')
kontaminant_025 <- data.frame( human_reads = sum(human025$reads),
bacterial_reads = sum(kontaminant_025$reads),
dataset='025',
condition='kontaminant')
human002 <- kontaminant_002 %>% filter(filename == 'GRCh38.fasta')
kontaminant_002 <- kontaminant_002 %>% filter(filename != 'GRCh38.fasta')
kontaminant_002 <- data.frame( human_reads = sum(human002$reads),
bacterial_reads = sum(kontaminant_002$reads),
dataset='002',
condition='kontaminant')
human004 <- kontaminant_004 %>% filter(filename == 'GRCh38.fasta')
kontaminant_004 <- kontaminant_004 %>% filter(filename != 'GRCh38.fasta')
kontaminant_004 <- data.frame( human_reads = sum(human004$reads),
bacterial_reads = sum(kontaminant_004$reads),
dataset='004',
condition='kontaminant')
human012 <- kontaminant_012 %>% filter(filename == 'GRCh38.fasta')
kontaminant_012 <- kontaminant_012 %>% filter(filename != 'GRCh38.fasta')
kontaminant_012 <- data.frame( human_reads = sum(human012$reads),
bacterial_reads = sum(kontaminant_012$reads),
dataset='012',
condition='kontaminant')
human015 <- kontaminant_015 %>% filter(filename == 'GRCh38.fasta')
kontaminant_015 <- kontaminant_015 %>% filter(filename != 'GRCh38.fasta')
kontaminant_015 <- data.frame( human_reads = sum(human015$reads),
bacterial_reads = sum(kontaminant_015$reads),
dataset='015',
condition='kontaminant')
human024 <- kontaminant_024 %>% filter(filename == 'GRCh38.fasta')
kontaminant_024 <- kontaminant_024 %>% filter(filename != 'GRCh38.fasta')
kontaminant_024 <- data.frame( human_reads = sum(human024$reads),
bacterial_reads = sum(kontaminant_024$reads),
dataset='024',
condition='kontaminant')
#form single data frame of all kontaminant results
kontaminant <- rbind(kontaminant_001, kontaminant_002, kontaminant_003, kontaminant_004, kontaminant_011, kontaminant_012, kontaminant_014, kontaminant_015, kontaminant_022, kontaminant_024, kontaminant_025)
rm(kontaminant_001, kontaminant_002, kontaminant_003, kontaminant_004, kontaminant_011, kontaminant_012, kontaminant_014, kontaminant_015, kontaminant_022, kontaminant_024, kontaminant_025)
rm(human001, human002, human003, human004, human011, human012, human014, human015, human022, human025, human024)
temp <- rbind(bbduk, bwa, bwa_bbduk, kontaminant, truth)
human_plot <- ggplot(temp, aes(y=((human_reads/1000000) ), fill=condition, colour=condition)) +
geom_boxplot() +
theme_pubclean() +
scale_fill_discrete(name='Test Condition',
breaks=c('bbduk', 'bwa', 'bwa_bbduk', 'kontaminant', 'truth'),
labels=c('BBDuK_Default', 'BWA-MEM', 'BWA & BBDuK Default', 'Kontaminant', 'Original')) +
scale_colour_discrete(name='Test Condition',
breaks=c('bbduk', 'bwa', 'bwa_bbduk', 'kontaminant', 'truth'),
labels=c('BBDuK_Default', 'BWA-MEM', 'BWA & BBDuK Default', 'Kontaminant', 'Original')) +
labs(title='Human Depletion Tool Performance',
y='Number of Human Reads (million)') +
scale_y_continuous(limits=c(0,300),
breaks=c(seq(0,300, 50))) +
theme(legend.title=element_text(hjust=0.5, size=12),
legend.text=element_text(size=12),
legend.position = 'right',
plot.title=element_text(hjust=0.5, size=12),
axis.text.x=element_blank(),
axis.text.y=element_text(size=12),
axis.title.y=element_text(size=12),
axis.ticks.x.bottom = element_blank())
human_plot
bacterial_plot <- ggplot(temp, aes(y=(bacterial_reads), fill=condition, color=condition)) +
geom_boxplot() +
scale_y_continuous(trans='log10') +
theme_pubclean() +
labs(title='Human Depletion - Bacterial Read Removal',
y='Number of Bacterial Reads') +
theme(legend.title=element_text(hjust=0.5),
legend.position = 'right',
plot.title=element_text(hjust=0.5, size=16),
axis.text.x=element_blank(),
axis.text.y=element_text(size=13),
axis.title.y=element_text(size=14),
axis.ticks.x.bottom = element_blank())
bacterial_plot
bacterial_plot <- ggplot(temp, aes(y=(bacterial_reads), fill=condition, color=condition)) +
geom_point() +
scale_y_continuous(trans='log10') +
theme_pubclean() +
labs(title='Human Depletion - Bacterial Read Removal',
y='Number of Bacterial Reads') +
theme(legend.title=element_text(hjust=0.5),
legend.position = 'right',
plot.title=element_text(hjust=0.5, size=16),
axis.text.x=element_blank(),
axis.text.y=element_text(size=13),
axis.title.y=element_text(size=14),
axis.ticks.x.bottom = element_blank())
bacterial_plot
bacterial_plot <- ggplot(temp, aes(y=(bacterial_reads), fill=condition, color=condition)) +
geom_point(aes(x=condition)) +
scale_y_continuous(trans='log10') +
theme_pubclean() +
labs(title='Human Depletion - Bacterial Read Removal',
y='Number of Bacterial Reads') +
theme(legend.title=element_text(hjust=0.5),
legend.position = 'right',
plot.title=element_text(hjust=0.5, size=16),
axis.text.x=element_blank(),
axis.text.y=element_text(size=13),
axis.title.y=element_text(size=14),
axis.ticks.x.bottom = element_blank())
bacterial_plot
bacterial_plot <- ggplot(temp, aes(y=(bacterial_reads), fill=condition, color=condition)) +
geom_boxplot(alpha=0.5) +
geom_point(aes(x=condition)) +
scale_y_continuous(trans='log10') +
theme_pubclean() +
labs(title='Human Depletion - Bacterial Read Removal',
y='Number of Bacterial Reads') +
theme(legend.title=element_text(hjust=0.5),
legend.position = 'right',
plot.title=element_text(hjust=0.5, size=16),
axis.text.x=element_blank(),
axis.text.y=element_text(size=13),
axis.title.y=element_text(size=14),
axis.ticks.x.bottom = element_blank())
bacterial_plot
bacterial_plot <- ggplot(temp, aes(y=(bacterial_reads), x=condition, fill=condition, color=condition)) +
geom_boxplot(alpha=0.5) +
geom_point(aes(x=condition)) +
scale_y_continuous(trans='log10') +
theme_pubclean() +
labs(title='Human Depletion - Bacterial Read Removal',
y='Number of Bacterial Reads') +
theme(legend.title=element_text(hjust=0.5),
legend.position = 'right',
plot.title=element_text(hjust=0.5, size=16),
axis.text.x=element_blank(),
axis.text.y=element_text(size=13),
axis.title.y=element_text(size=14),
axis.ticks.x.bottom = element_blank())
bacterial_plot
human_plot
human_plot <- ggplot(temp, aes(y=((human_reads/1000000) ), fill=condition, colour=condition)) +
geom_jitter() +
geom_boxplot() +
theme_pubclean() +
scale_fill_discrete(name='Test Condition',
breaks=c('bbduk', 'bwa', 'bwa_bbduk', 'kontaminant', 'truth'),
labels=c('BBDuK_Default', 'BWA-MEM', 'BWA & BBDuK Default', 'Kontaminant', 'Original')) +
scale_colour_discrete(name='Test Condition',
breaks=c('bbduk', 'bwa', 'bwa_bbduk', 'kontaminant', 'truth'),
labels=c('BBDuK_Default', 'BWA-MEM', 'BWA & BBDuK Default', 'Kontaminant', 'Original')) +
labs(title='Human Depletion Tool Performance',
y='Number of Human Reads (million)') +
scale_y_continuous(limits=c(0,300),
breaks=c(seq(0,300, 50))) +
theme(legend.title=element_text(hjust=0.5, size=12),
legend.text=element_text(size=12),
legend.position = 'right',
plot.title=element_text(hjust=0.5, size=12),
axis.text.x=element_blank(),
axis.text.y=element_text(size=12),
axis.title.y=element_text(size=12),
axis.ticks.x.bottom = element_blank())
human_plot
human_plot <- ggplot(temp, aes(y=((human_reads/1000000) ), fill=condition, colour=condition)) +
geom_jitter(aes(x=condition)) +
geom_boxplot(alpha=0.5) +
theme_pubclean() +
scale_fill_discrete(name='Test Condition',
breaks=c('bbduk', 'bwa', 'bwa_bbduk', 'kontaminant', 'truth'),
labels=c('BBDuK_Default', 'BWA-MEM', 'BWA & BBDuK Default', 'Kontaminant', 'Original')) +
scale_colour_discrete(name='Test Condition',
breaks=c('bbduk', 'bwa', 'bwa_bbduk', 'kontaminant', 'truth'),
labels=c('BBDuK_Default', 'BWA-MEM', 'BWA & BBDuK Default', 'Kontaminant', 'Original')) +
labs(title='Human Depletion Tool Performance',
y='Number of Human Reads (million)') +
scale_y_continuous(limits=c(0,300),
breaks=c(seq(0,300, 50))) +
theme(legend.title=element_text(hjust=0.5, size=12),
legend.text=element_text(size=12),
legend.position = 'right',
plot.title=element_text(hjust=0.5, size=12),
axis.text.x=element_blank(),
axis.text.y=element_text(size=12),
axis.title.y=element_text(size=12),
axis.ticks.x.bottom = element_blank())
human_plot
human_plot <- ggplot(temp, aes(y=((human_reads/1000000), x=condition ), fill=condition, colour=condition)) +
geom_jitter() +
geom_boxplot(alpha=0.5) +
theme_pubclean() +
scale_fill_discrete(name='Test Condition',
breaks=c('bbduk', 'bwa', 'bwa_bbduk', 'kontaminant', 'truth'),
labels=c('BBDuK_Default', 'BWA-MEM', 'BWA & BBDuK Default', 'Kontaminant', 'Original')) +
scale_colour_discrete(name='Test Condition',
breaks=c('bbduk', 'bwa', 'bwa_bbduk', 'kontaminant', 'truth'),
labels=c('BBDuK_Default', 'BWA-MEM', 'BWA & BBDuK Default', 'Kontaminant', 'Original')) +
labs(title='Human Depletion Tool Performance',
y='Number of Human Reads (million)') +
scale_y_continuous(limits=c(0,300),
breaks=c(seq(0,300, 50))) +
theme(legend.title=element_text(hjust=0.5, size=12),
legend.text=element_text(size=12),
legend.position = 'right',
plot.title=element_text(hjust=0.5, size=12),
axis.text.x=element_blank(),
axis.text.y=element_text(size=12),
axis.title.y=element_text(size=12),
axis.ticks.x.bottom = element_blank())
human_plot
human_plot <- ggplot(temp, aes(y=((human_reads/1000000)), fill=condition, colour=condition)) +
geom_boxplot(alpha=0.5) +
theme_pubclean() +
scale_fill_discrete(name='Test Condition',
breaks=c('bbduk', 'bwa', 'bwa_bbduk', 'kontaminant', 'truth'),
labels=c('BBDuK_Default', 'BWA-MEM', 'BWA & BBDuK Default', 'Kontaminant', 'Original')) +
scale_colour_discrete(name='Test Condition',
breaks=c('bbduk', 'bwa', 'bwa_bbduk', 'kontaminant', 'truth'),
labels=c('BBDuK_Default', 'BWA-MEM', 'BWA & BBDuK Default', 'Kontaminant', 'Original')) +
labs(title='Human Depletion Tool Performance',
y='Number of Human Reads (million)') +
scale_y_continuous(limits=c(0,300),
breaks=c(seq(0,300, 50))) +
theme(legend.title=element_text(hjust=0.5, size=12),
legend.text=element_text(size=12),
legend.position = 'right',
plot.title=element_text(hjust=0.5, size=12),
axis.text.x=element_blank(),
axis.text.y=element_text(size=12),
axis.title.y=element_text(size=12),
axis.ticks.x.bottom = element_blank())
human_plot
bacterial_plot <- ggplot(temp, aes(y=(bacterial_reads), x=condition, fill=condition, color=condition)) +
geom_boxplot(alpha=0.5) +
geom_point(aes(x=condition)) +
scale_y_continuous(trans='log10') +
theme_pubclean() +
labs(title='Human Depletion - Bacterial Read Removal',
y='Number of Bacterial Reads') +
theme(legend.title=element_text(hjust=0.5),
legend.position = 'right',
plot.title=element_text(hjust=0.5, size=16),
axis.text.x=element_blank(),
axis.text.y=element_text(size=13),
axis.title.y=element_text(size=14),
axis.ticks.x.bottom = element_blank())
bacterial_plot
bacterial_plot <- ggplot(temp, aes(y=(bacterial_reads/1000000), x=condition, fill=condition, color=condition)) +
geom_boxplot(alpha=0.5) +
geom_point(aes(x=condition)) +
scale_y_continuous(trans='log10') +
theme_pubclean() +
labs(title='Human Depletion - Bacterial Read Removal',
y='Number of Bacterial Reads (million)') +
theme(legend.title=element_text(hjust=0.5),
legend.position = 'right',
plot.title=element_text(hjust=0.5, size=16),
axis.text.x=element_blank(),
axis.text.y=element_text(size=13),
axis.title.y=element_text(size=14),
axis.ticks.x.bottom = element_blank())
bacterial_plot
pdf('~/Desktop/SEPATH_Figures/human_depletion_plot.pdf', height=4, width=6)
human_plot
dev.off()
pdf('~/Desktop/SEPATH_Figures/bacterial_depletion_plot.pdf', height=10, width=10)
bacterial_plot
dev.off()
library(tidyverse)
library(tidyr)
library(reshape2)
library(cowplot)
mcf_50 <- read_tsv(file='/Users/agihawi/Desktop/human_depletion/mcf50_counts', col_names = TRUE)
mkf_50 <- read_tsv(file='/Users/agihawi/Desktop/human_depletion/mkf_50_counts', col_names = TRUE)
mcf_75 <- read_tsv(file='/Users/agihawi/Desktop/human_depletion/mcf075_counts', col_names = TRUE)
mkf_75 <- read_tsv(file='/Users/agihawi/Desktop/human_depletion/mkf075_counts', col_names = TRUE)
mkf_90 <- read_tsv(file='/Users/agihawi/Desktop/human_depletion/mkf90_counts', col_names = TRUE)
original <- read_tsv(file='/Users/agihawi/Desktop/human_depletion/original_counts', col_names = TRUE)
stringent <- read_tsv(file='/Users/agihawi/Desktop/human_depletion/stringent_counts', col_names = TRUE)
cancer_filt <- read_tsv(file='/Users/agihawi/Desktop/human_depletion/mcf50_cancer_counts', col_names=TRUE)
# mcf_90 <- read_tsv(file='/Users/agihawi/Desktop/human_depletion/mcf090_counts', col_names = TRUE)
all_bbduk <- cbind(mcf_50, mkf_50, mcf_75, mkf_75, mkf_90, original, cancer_filt, stringent)
all_bbduk$mcf50_bac_prop <- all_bbduk$mcf50_bacterial / all_bbduk$original_bacterial
all_bbduk$mcf75_bac_prop <- all_bbduk$mcf75_bacterial / all_bbduk$original_bacterial
all_bbduk$mkf50_bac_prop <- all_bbduk$mkf50_bacterial / all_bbduk$original_bacterial
all_bbduk$mkf75_bac_prop <- all_bbduk$mkf75_bacterial / all_bbduk$original_bacterial
all_bbduk$mkf90_bac_prop <- all_bbduk$mkf90_bacterial / all_bbduk$original_bacterial
all_bbduk$stringent_bac_prop <- all_bbduk$stringent_bacterial / all_bbduk$original_bacterial
all_bbduk$cancer_bac_prob <- all_bbduk$cancer_mcf50_bacterial / all_bbduk$original_bacterial
all_bbduk$mcf50_hum_prop <- all_bbduk$mcf50_human / all_bbduk$original_human
all_bbduk$mcf75_hum_prop <- all_bbduk$mcf75_human / all_bbduk$original_human
all_bbduk$mkf50_hum_prop <- all_bbduk$mkf50_human / all_bbduk$original_human
all_bbduk$mkf75_hum_prop <- all_bbduk$mkf75_human / all_bbduk$original_human
all_bbduk$mkf90_hum_prop <- all_bbduk$mkf90_human / all_bbduk$original_human
all_bbduk$stringent_hum_prop <- all_bbduk$stringent_human / all_bbduk$original_human
all_bbduk$cancer_hum_prop <- all_bbduk$cancer_mcf50_human / all_bbduk$original_human
#need to also include 1 kmer filtering
bac_plot_data <- all_bbduk %>% select(mcf50_bac_prop, mcf75_bac_prop, mkf50_bac_prop, mkf75_bac_prop, mkf90_bac_prop, cancer_bac_prob, stringent_bac_prop)
hum_plot_data <- all_bbduk %>% select(mcf50_hum_prop, mcf75_hum_prop, mkf50_hum_prop, mkf75_hum_prop, mkf90_hum_prop, cancer_hum_prop, stringent_hum_prop)
bac_melt <- melt(bac_plot_data)
hum_melt <- melt(hum_plot_data)
bplot <- ggplot(data=bac_melt, aes(x=factor(variable), y=value, fill=variable)) +
geom_boxplot() +
labs(title="BBDuk Filtering Parameters - Bacterial Reads",
subtitle="",
y="Proportion of Bacterial Reads Remaining",
x='BBDuk Filtering Parameters') +
theme_pubclean() +
theme(plot.title=element_text(hjust=0.5, size=12),
plot.subtitle=element_text(hjust=0.5, size=12),
axis.text.x=element_text(angle=90, hjust=1, size=12),
axis.title.x=element_text(hjust=0.5, size=12),
axis.text.y=element_text(size=12),
axis.title.y=element_text(hjust=0.5, size=12),
legend.position='none') +
scale_x_discrete(limits=c('mcf50_bac_prop', 'mcf75_bac_prop', 'mkf50_bac_prop', 'mkf75_bac_prop', 'mkf90_bac_prop', 'cancer_bac_prob', 'stringent_bac_prop'),
labels=c('MCF50','MCF75','MKF50','MKF75','MKF90','MCF50-Cancer','Default'))
bplot
aplot <- ggplot(data=hum_melt, aes(x=factor(variable), y=(log10(value)))) +
geom_boxplot() +
labs(title="BBDuk Filtering Parameters - Human Reads",
subtitle="",
y="Proportion of Human Reads Remaining (log10)",
x='BBDuk Filtering Parameters') +
theme_pubclean() +
theme(plot.title=element_text(hjust=0.5, size=12),
plot.subtitle=element_text(hjust=0.5, size=12),
axis.text.x=element_text(angle=90, hjust=1, size=12),
axis.title.x=element_text(hjust=0.5, size=12),
axis.title.y=element_text(size=12),
axis.text.y=element_text(size=12)) +
scale_x_discrete(limits=c('mcf50_hum_prop', 'mcf75_hum_prop', 'mkf50_hum_prop', 'mkf75_hum_prop', 'mkf90_hum_prop', 'cancer_hum_prop', 'stringent_hum_prop'),
labels=c('MCF50','MCF75','MKF50','MKF75','MKF90','MCF50-Cancer','Default'))
aplot
mcf_50 <- read_tsv(file='/Users/agihawi/Desktop/Archive/human_depletion/mcf50_counts', col_names = TRUE)
mkf_50 <- read_tsv(file='/Users/agihawi/Desktop/Archive/human_depletion/mkf_50_counts', col_names = TRUE)
mcf_75 <- read_tsv(file='/Users/agihawi/Desktop/Archive/human_depletion/mcf075_counts', col_names = TRUE)
mkf_75 <- read_tsv(file='/Users/agihawi/Desktop/Archive/human_depletion/mkf075_counts', col_names = TRUE)
mkf_90 <- read_tsv(file='/Users/agihawi/Desktop/Archive/human_depletion/mkf90_counts', col_names = TRUE)
original <- read_tsv(file='/Users/agihawi/Desktop/Archive/human_depletion/original_counts', col_names = TRUE)
stringent <- read_tsv(file='/Users/agihawi/Desktop/Archive/human_depletion/stringent_counts', col_names = TRUE)
cancer_filt <- read_tsv(file='/Users/agihawi/Desktop/Archive/human_depletion/mcf50_cancer_counts', col_names=TRUE)
all_bbduk <- cbind(mcf_50, mkf_50, mcf_75, mkf_75, mkf_90, original, cancer_filt, stringent)
all_bbduk$mcf50_bac_prop <- all_bbduk$mcf50_bacterial / all_bbduk$original_bacterial
all_bbduk$mcf75_bac_prop <- all_bbduk$mcf75_bacterial / all_bbduk$original_bacterial
all_bbduk$mkf50_bac_prop <- all_bbduk$mkf50_bacterial / all_bbduk$original_bacterial
all_bbduk$mkf75_bac_prop <- all_bbduk$mkf75_bacterial / all_bbduk$original_bacterial
all_bbduk$mkf90_bac_prop <- all_bbduk$mkf90_bacterial / all_bbduk$original_bacterial
all_bbduk$stringent_bac_prop <- all_bbduk$stringent_bacterial / all_bbduk$original_bacterial
all_bbduk$cancer_bac_prob <- all_bbduk$cancer_mcf50_bacterial / all_bbduk$original_bacterial
all_bbduk$mcf50_hum_prop <- all_bbduk$mcf50_human / all_bbduk$original_human
all_bbduk$mcf75_hum_prop <- all_bbduk$mcf75_human / all_bbduk$original_human
all_bbduk$mkf50_hum_prop <- all_bbduk$mkf50_human / all_bbduk$original_human
all_bbduk$mkf75_hum_prop <- all_bbduk$mkf75_human / all_bbduk$original_human
all_bbduk$mkf90_hum_prop <- all_bbduk$mkf90_human / all_bbduk$original_human
all_bbduk$stringent_hum_prop <- all_bbduk$stringent_human / all_bbduk$original_human
all_bbduk$cancer_hum_prop <- all_bbduk$cancer_mcf50_human / all_bbduk$original_human
bac_plot_data <- all_bbduk %>% select(mcf50_bac_prop, mcf75_bac_prop, mkf50_bac_prop, mkf75_bac_prop, mkf90_bac_prop, cancer_bac_prob, stringent_bac_prop)
hum_plot_data <- all_bbduk %>% select(mcf50_hum_prop, mcf75_hum_prop, mkf50_hum_prop, mkf75_hum_prop, mkf90_hum_prop, cancer_hum_prop, stringent_hum_prop)
bac_melt <- melt(bac_plot_data)
hum_melt <- melt(hum_plot_data)
bplot <- ggplot(data=bac_melt, aes(x=factor(variable), y=value, fill=variable)) +
geom_boxplot() +
labs(title="BBDuk Filtering Parameters - Bacterial Reads",
subtitle="",
y="Proportion of Bacterial Reads Remaining",
x='BBDuk Filtering Parameters') +
theme_pubclean() +
theme(plot.title=element_text(hjust=0.5, size=12),
plot.subtitle=element_text(hjust=0.5, size=12),
axis.text.x=element_text(angle=90, hjust=1, size=12),
axis.title.x=element_text(hjust=0.5, size=12),
axis.text.y=element_text(size=12),
axis.title.y=element_text(hjust=0.5, size=12),
legend.position='none') +
scale_x_discrete(limits=c('mcf50_bac_prop', 'mcf75_bac_prop', 'mkf50_bac_prop', 'mkf75_bac_prop', 'mkf90_bac_prop', 'cancer_bac_prob', 'stringent_bac_prop'),
labels=c('MCF50','MCF75','MKF50','MKF75','MKF90','MCF50-Cancer','Default'))
bplot
aplot <- ggplot(data=hum_melt, aes(x=factor(variable), y=(log10(value)))) +
geom_boxplot() +
labs(title="BBDuk Filtering Parameters - Human Reads",
subtitle="",
y="Proportion of Human Reads Remaining (log10)",
x='BBDuk Filtering Parameters') +
theme_pubclean() +
theme(plot.title=element_text(hjust=0.5, size=12),
plot.subtitle=element_text(hjust=0.5, size=12),
axis.text.x=element_text(angle=90, hjust=1, size=12),
axis.title.x=element_text(hjust=0.5, size=12),
axis.title.y=element_text(size=12),
axis.text.y=element_text(size=12)) +
scale_x_discrete(limits=c('mcf50_hum_prop', 'mcf75_hum_prop', 'mkf50_hum_prop', 'mkf75_hum_prop', 'mkf90_hum_prop', 'cancer_hum_prop', 'stringent_hum_prop'),
labels=c('MCF50','MCF75','MKF50','MKF75','MKF90','MCF50-Cancer','Default'))
aplot
pdf('~/Desktop/sepath_paper/human_depletion/bbduk_parameters/bbduk_plot.pdf', height=6, width=12)
plot_grid(aplot, bplot, labels = c("A", "B"))
dev.off()
#after loding in human plot from analysis_script.R (human depletion tool comparison)
pdf('~/Desktop/SEPATH_V3/figures/figure1.pdf', width=16, height=5)
#after loding in human plot from analysis_script.R (human depletion tool comparison)
pdf('~/Desktop/SEPATH_V5/figures/figure1.pdf', width=16, height=5)
plot_grid(human_plot, aplot, bplot, labels=c("A", "B", "C"), nrow=1, scale=0.9)
dev.off()
plot_grid(human_plot, aplot, bplot, labels=c("A", "B", "C"), nrow=1, scale=0.9)
#after loding in human plot from analysis_script.R (human depletion tool comparison)
pdf('~/Desktop/SEPATH_V5/figures/figure1.pdf', width=16, height=5)
plot_grid(human_plot, aplot, bplot, labels=c("A", "B", "C"), nrow=1, scale=0.9)
dev.off()
plot_grid(human_plot, aplot, bplot, labels=c("A", "B", "C"), nrow=1, scale=0.9)
system('open ~/Desktop/SEPATH_V5/figures/figure1.pdf')
View(kontaminant)
median(kontaminant$bacterial_reads)
median(bbduk$bacterial_reads)
15163258 - 15157498
View(temp)
median(bbduk$human_reads)
median(kontaminant$human_reads)
View(temp)
View(mcf50_bbduk)
median(mcf50_bbduk$human_reads)
View(bbduk)
View(bbduk)
